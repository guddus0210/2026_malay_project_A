# 🧠 적응형 강화학습(RLHF Lite) - Excel 기반 구현 계획서

## 1. 개요 (Overview)

**목표**: 팀 프로젝트 환경에 맞춰 **별도의 DB 서버 없이**, 기존 **Excel 파일**을 활용하여 사용자의 좋아요/싫어요(Feedback)를 기록하고 학습하는 **자가 발전형 챗봇** 구현.

**전략**: **"Feedback as a Sheet"**
- `Chatbot_TestData.xlsx` 파일 내에 `Feedback_Log`라는 새로운 시트를 만들어 데이터베이스처럼 활용합니다.
- 복잡한 인프라 설정 없이 즉시 구현 가능하며, 추후 DB로의 전환도 용이합니다.

---

## 2. 시스템 데이터 구조 (Excel Schema)

기존 `Chatbot_TestData.xlsx` 파일에 **새로운 시트**를 추가하여 관리합니다.

### � 시트명: `Feedback_Log`
| Column | 설명 | 예시 |
|--------|------|------|
| **User_Query** | 사용자의 질문 | "등록금은 얼마인가요?" |
| **AI_Response** | 챗봇의 답변 | "등록금 정보는 홈페이지를 참조하세요." |
| **Score** | 피드백 점수 | `1` (좋아요) 또는 `-1` (싫어요) |
| **Date** | 기록 시간 | 2026-02-05 14:00:00 |
| **Context** | 당시 참조한 데이터 | (검색된 학생 정보 등) |

---

## 3. 구현 로드맵 (Roadmap)

### 1단계: Data Engine 업그레이드 (Backend)
- **파일**: `data_engine.py`
- **작업**:
    - `save_feedback(query, response, score)` 함수 추가
        - 엑셀 파일의 `Feedback_Log` 시트에 새로운 행(Row)을 추가하여 저장.
    - `get_good_responses(query)` 함수 추가
        - 사용자가 입력한 질문과 유사한 과거 질문 중, **좋아요(Score=1)**를 받은 답변을 검색하여 반환.
        - *초기 구현*: 간단한 키워드 포함 여부(contains)로 검색.

### 2단계: API 확장 (Backend)
- **파일**: `main.py`
- **작업**:
    - `POST /api/feedback` 엔드포인트 생성
    - 프론트엔드에서 받은 피드백 데이터를 `data_engine`을 통해 엑셀에 저장.

### 3단계: AI 엔진 연동 (Adaptive AI Logic)
- **파일**: `ai_engine.py`
- **작업**: `get_response` 메서드 수정
    1. 사용자 질문 수신
    2. `data_engine.get_good_responses()`를 호출하여 **"과거의 칭찬받은 답변"** 조회
    3. 프롬프트 강화:
       > "System: 예전에 사용자가 '{질문}'이라고 물었을 때, '{과거_답변}'라고 대답하니 좋아했어. 이 정보를 참고해서 이번에도 답변해 줘."

### 4단계: UI 버튼 추가 (Frontend)
- **파일**: `code_hompage.html`
- **작업**:
    - AI 메시지 말풍선 하단에 작게 👍 / 👎 버튼 배치
    - 버튼 클릭 시 API 호출 및 "피드백 감사합니다" 토스트 메시지 표시

---

## 4. 예상 워크플로우 (Scenario)

1.  **사용자**: "기숙사비 얼마야?"
2.  **AI (초기)**: "기숙사 정보가 없습니다."
3.  **사용자**: 👎 (싫어요) 클릭 → **Excel에 기록됨 (Score: -1)**
    --------------------------------------------------
    * (팀원이 엑셀 파일을 열어 답변을 "월 30만원입니다"로 수동 수정하거나, 나중에 AI가 학습해서 맞춤)*
    --------------------------------------------------
4.  **사용자 (재질문)**: "기숙사 비용 알려줘"
5.  **AI (적응)**: (엑셀에서 과거 피드백 기록 확인 → "오답 노트" 확인 또는 "모범 답안" 확인)
    - 만약 누군가 모범 답안을 입력해뒀다면: "월 30만원입니다."
6.  **사용자**: 👍 (좋아요) 클릭 → **Excel에 모범 답안으로 기록됨 (Score: 1)**
7.  **이후**: AI는 이 질문에 대해 항상 "월 30만원입니다."를 우선적으로 참고하게 됨.

---

## 5. 기대 효과

1.  **Zero Infrastructure**: 추가적인 서버 설치 없이 파일 하나로 기능 구현.
2.  **Team Collaboration**: 팀원들이 엑셀 파일을 열어 사용자가 무엇을 물어봤는지, 어떤 답변을 싫어했는지 눈으로 확인하고 데이터를 보강할 수 있음.
3.  **Scalability**: 나중에 이 엑셀 데이터를 그대로 DB에 `Import`하면 되므로 확장에 문제없음.
